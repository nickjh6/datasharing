---
title: "Final Project_Ames"
author: "Nick Howard"
date: "March 3, 2019"
output:
  pdf_document: default
  html_document: default
---

```{r}

getwd()

setwd("C:/Users/Nicholas Howard/Downloads/house-prices-advanced-regression-techniques")

train=read.csv(file="train.csv")


sapply(train, function(x) sum(is.na(x)))

names(train)
 
 newtrain <- c('Id','MSZoning','MSSubClass', 'Neighborhood','BldgType','OverallCond','ExterCond','BsmtQual','BsmtCond','TotalBsmtSF','Heating','HeatingQC','CentralAir','Electrical','GrLivArea','BedroomAbvGr','KitchenAbvGr','GarageArea','YrSold','SaleType','SaleCondition','SalePrice','LotArea' ,'OverallCond', 'YrSold','SalePrice', 'X1stFlrSF', 'X2ndFlrSF', 'TotalBsmtSF', 'GrLivArea', 'BsmtFinSF1' )
 
 subset_train <- train[,newtrain]
 
 subset_train$ExterCond2 <- as.numeric(factor(subset_train$ExterCond, 
                                          levels = c("Ex", "Fa","Gd", "TA","Po"),
                                          labels = c(5,2,4,3,1) ,ordered = TRUE))
subset_train$HeatingQC2 <- as.numeric(factor(subset_train$HeatingQC, 
                                          levels = c("Ex", "Fa","Gd", "TA","Po"),
                                          labels = c(5,2,4,3,1) ,ordered = TRUE))
subset_train$CentralAir2 <- as.numeric(factor(subset_train$CentralAir, 
                                           levels = c("N", "Y"),
                                           labels = c(0,1) ,ordered = TRUE))
subset_train$BldgType<- as.numeric(factor(subset_train$BldgType,
                                          levels = c("1Fam","2FmCon","Duplx","TwnhsE","TwnhsI"),
                                                     labels = c(5,4,3,2,1),ordered = TRUE))

head(subset_train$ExterCond2)
head(subset_train$CentralAir2)
head(subset_train$BldgType)

sapply(subset_train, function(x) sum(is.na(x)))

library(plyr)

ddply(subset_train,.(MSZoning),summarize,price = mean(SalePrice))
ddply(subset_train,.(subset_train$BldgType),summarize,price = mean(SalePrice))
ddply(subset_train,.(subset_train$ExterCond),summarize,price = mean(SalePrice))
 
 library(ggplot2)
 
 ggplot(subset_train, aes(x = subset_train$SalePrice,fill = as.factor(subset_train$YrSold))) +
    geom_histogram(position = "stack", binwidth = 10000) +
    ggtitle("Figure 6 Histogram of SalePrice") +
    ylab("Count") +
    xlab("Housing Price") + 
    scale_fill_discrete(name="subset_train$Yrsold")+
    theme(plot.title = element_text(hjust = 0.5), legend.position=c(0.87,0.855), legend.background = element_rect(fill="white",
                                                                                                               size=0.5, linetype="solid", 
                                                                                                               colour ="black"))

qplot(subset_train$SalePrice,
             geom="histogram",
             binwidth = 50000,  
             main = "Sales Price of Homes in Ames, IA", 
             xlab = "Home Price",  
             fill=I("blue"), 
             col=I("black"), 
             alpha=I(.2),
             xlim=c(0,1000000))


 newtrainnum <- c('SalePrice','MSSubClass','TotalBsmtSF','GrLivArea','BedroomAbvGr','KitchenAbvGr','GarageArea','LotArea' ,'OverallCond', 'YrSold', 'X1stFlrSF', 'X2ndFlrSF', 'TotalBsmtSF', 'GrLivArea', 'BsmtFinSF1' )
 
 subset_trainnum <- train[,newtrainnum]

library(corrplot)

Correlation<-cor(na.omit(subset_trainnum))
corrplot(Correlation)

## I will examine the relationship between SF and sales price


 ggplot(subset_train, aes(x=subset_train$SalePrice, y=subset_train$LotArea)) +
     geom_point(shape=1) +    
     geom_smooth(method=lm,   
                se=FALSE)  


ggplot(subset_train, aes(x=subset_train$SalePrice, y=subset_train$X2ndFlrSF)) +
        geom_point(shape=1) +    
        geom_smooth(method=lm,   
                       se=FALSE)

ggplot(subset_train, aes(x=subset_train$SalePrice, y=subset_train$X1stFlrSF)) +
        geom_point(shape=1) +    
        geom_smooth(method=lm,   
                       se=FALSE)

ggplot(subset_train, aes(x=subset_train$SalePrice, y=subset_train$TotalBsmtSF)) +
        geom_point(shape=1) +    
        geom_smooth(method=lm,   
                       se=FALSE)

ggplot(subset_train, aes(x=subset_train$SalePrice, y=subset_train$GrLivArea)) +
        geom_point(shape=1) +    
        geom_smooth(method=lm,   
                       se=FALSE)

ggplot(subset_trainnum, aes(x=subset_trainnum$SalePrice, y=subset_trainnum$BsmtFinSF1)) +
        geom_point(shape=1) +    
        geom_smooth(method=lm,   
                       se=FALSE)

lm_var <- c('SalePrice','TotalBsmtSF','GrLivArea','BedroomAbvGr','KitchenAbvGr','GarageArea','LotArea' ,'OverallCond', 'YrSold', 'X1stFlrSF', 'X2ndFlrSF')

subset_trainlm <- train[,lm_var]

head(subset_trainlm$SalePrice)

head(subset_trainlm)

LINREG <- lm(subset_trainlm$SalePrice~.,subset_trainlm)

summary(LINREG)

anova(LINREG)

test=read.csv(file="test.csv")

lm_vartest <- c('TotalBsmtSF','GrLivArea','BedroomAbvGr','KitchenAbvGr','GarageArea','LotArea' ,'OverallCond', 'YrSold', 'X1stFlrSF', 'X2ndFlrSF')

subset_testlm <- test[,lm_vartest]

predict(LINREG,subset_testlm,type = "response")

##Second LM without high P values

lm_var <- c('SalePrice','TotalBsmtSF','BedroomAbvGr','KitchenAbvGr','GarageArea' ,'OverallCond', 'X1stFlrSF', 'X2ndFlrSF')

subset_trainlm <- train[,lm_var]

head(subset_trainlm$SalePrice)

head(subset_trainlm)

LINREG <- lm(subset_trainlm$SalePrice~.,subset_trainlm)

summary(LINREG)

lm_vartest2 <- c('TotalBsmtSF','BedroomAbvGr','KitchenAbvGr','GarageArea' ,'OverallCond', 'X1stFlrSF', 'X2ndFlrSF')

subset_testlm <- test[,lm_vartest2]

predict(LINREG,subset_testlm,type = "response")
```

